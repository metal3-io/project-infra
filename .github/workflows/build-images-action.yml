name: build-images-action

on:
  repository_dispatch:
  push:
    branches:
    - 'main'
    paths:
    - 'prow/container-images/**/Dockerfile'
    - '.github/workflows/build-images-action.yml'
    - '.github/workflows/container-image-build.yml'

jobs:
  build_basic_checks:
    name: Build basic-checks image
    if: github.repository == 'metal3-io/project-infra'
    permissions:
      contents: read
      id-token: write
    uses: ./.github/workflows/container-image-build.yml
    with:
      image-name: 'basic-checks'
      image-tag: 'golang-1.25'
      dockerfile-directory: 'prow/container-images/basic-checks'
      pushImage: true
      generate-sbom: true
      sign-image: true
    secrets:
      QUAY_USERNAME: ${{ secrets.QUAY_USERNAME }}
      QUAY_PASSWORD: ${{ secrets.QUAY_PASSWORD }}
      SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
